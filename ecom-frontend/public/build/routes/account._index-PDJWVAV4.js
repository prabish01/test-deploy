import{b}from"/build/_shared/chunk-66LLSQOW.js";import{a as T}from"/build/_shared/chunk-MPNUWWH6.js";import{a as r}from"/build/_shared/chunk-QTXY3SDL.js";import{a as N}from"/build/_shared/chunk-HZSDWWGA.js";import{a as d}from"/build/_shared/chunk-PYYTX6MH.js";import{a as l}from"/build/_shared/chunk-W4ZSGTTH.js";import{b as v,c as E,d as s}from"/build/_shared/chunk-PNHWE22R.js";import{b as h}from"/build/_shared/chunk-FH6P7PUH.js";import"/build/_shared/chunk-TEQ7JZCS.js";import"/build/_shared/chunk-ZVWHBDYW.js";import"/build/_shared/chunk-BPJTJPQP.js";import{c as H,f,l as q}from"/build/_shared/chunk-NATW5ST3.js";import{C as A,E as B,a as O,h as I,v as S,w as k}from"/build/_shared/chunk-MTQ3NDKQ.js";import{d as g}from"/build/_shared/chunk-2QEWK57A.js";var a=g(O(),1);var e=g(B(),1);var P=E(s.object({title:s.string(),firstName:s.string().min(1,{message:"First name is required"}),lastName:s.string().min(1,{message:"Last name is required"}),phoneNumber:s.string()})),_=E(s.object({email:s.string().min(1,{message:"Email is required"}).email("Must be a valid email"),password:s.string().min(1,{message:"Password is required"})}));function X(n){return n.message!==void 0}function Z(n){return n.newEmailAddress!==void 0}function G(n){return n.customerUpdated!==void 0}function V(){let{activeCustomer:n}=S(),o=k(),{t}=A(),{firstName:y,lastName:w,title:u,phoneNumber:F,emailAddress:M}=n,L=`${u?u+" ":""}${y} ${w}`,{state:x}=I(),[i,C]=(0,a.useState)(),[R,$]=(0,a.useState)(),[j,z,c]=T(!1),[m,p]=(0,a.useState)(!1),U=(0,a.useRef)(null),D=(0,a.useRef)(null);return(0,a.useEffect)(()=>{if(o){if(Z(o)){$(o),c();return}if(G(o)){p(!1),C(void 0);return}if(X(o)){C(o);return}}},[o]),(0,a.useEffect)(()=>{D.current?.reset()},[m]),(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(d,{isOpen:j,close:()=>c(),afterOpen:()=>U.current?.focus(),size:"small",children:(0,e.jsxs)(v,{validator:_,method:"post",children:[(0,e.jsx)(d.Title,{children:t("account.changeEmailModal.title")}),(0,e.jsx)(d.Body,{children:(0,e.jsxs)("div",{className:"space-y-4 my-8",children:[(0,e.jsx)("p",{children:t("account.changeEmailModal.heading")}),(0,e.jsxs)("p",{children:[t("account.changeEmailModal.currentEmail")," ",(0,e.jsx)("strong",{children:M})]}),(0,e.jsxs)("div",{className:"space-y-1",children:[(0,e.jsx)("input",{type:"hidden",name:"intent",value:"updateEmail"}),(0,e.jsx)(r,{ref:U,autoFocus:!0,label:t("account.changeEmailModal.new"),name:"email",required:!0}),(0,e.jsx)(r,{label:t("account.password"),type:"password",name:"password",required:!0}),(0,e.jsx)("input",{type:"submit",hidden:!0})]}),i&&i.intent==="updateEmail"&&(0,e.jsx)(N,{heading:t("account.changeEmailModal.errorMessage"),message:i.message})]})}),(0,e.jsxs)(d.Footer,{children:[(0,e.jsx)(h,{type:"reset",onClick:()=>c(),children:t("common.cancel")}),(0,e.jsx)(l,{type:"submit",isSubmitting:x==="submitting",children:t("common.save")})]})]})}),(0,e.jsxs)("div",{className:"space-y-10 p-4 mt-5",children:[(0,e.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,e.jsxs)("div",{className:"col-span-2",children:[(0,e.jsx)("h3",{className:"text-sm text-gray-500",children:t("account.email")}),R?(0,e.jsxs)("span",{children:[(0,e.jsx)("span",{className:"italic text-gray-800",children:R.newEmailAddress}),(0,e.jsx)("span",{className:"ml-2 bg-blue-100 text-blue-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded dark:bg-blue-900 dark:text-blue-300",children:t("account.changeEmailConfirmation")})]}):(0,e.jsx)("span",{children:M})]}),(0,e.jsx)("div",{className:"col-span-2",children:(0,e.jsxs)(l,{type:"button",onClick:()=>z(),children:[(0,e.jsx)(f,{className:"w-4 h-4"})," ",t("account.changeEmailButton")]})})]}),(0,e.jsx)("div",{className:"border-t border-gray-200 pt-10",children:(0,e.jsxs)(v,{validator:P,formRef:D,method:"post",id:"details",defaultValues:{title:u??void 0,firstName:y,lastName:w,phoneNumber:F??void 0},children:[(0,e.jsx)("input",{type:"hidden",name:"intent",value:"updateDetails"}),(0,e.jsxs)("div",{className:"gap-4 grid sm:grid-cols-2",children:[m&&(0,e.jsx)("div",{className:"col-span-2",children:(0,e.jsx)(r,{label:t("account.title"),name:"title",className:"sm:w-1/4"})}),m?(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("div",{children:(0,e.jsx)(r,{label:t("account.firstName"),name:"firstName",required:!0})}),(0,e.jsx)("div",{children:(0,e.jsx)(r,{label:t("account.lastName"),name:"lastName",required:!0})})]}):(0,e.jsxs)("div",{children:[(0,e.jsx)("h3",{className:"text-sm text-gray-500",children:t("account.fullName")}),b(L)]}),(0,e.jsx)("div",{children:m?(0,e.jsx)(r,{label:t("account.phoneNumber"),name:"phoneNumber"}):(0,e.jsxs)("div",{children:[(0,e.jsx)("h3",{className:"text-sm text-gray-500",children:t("account.phoneNumber")}),b(F)]})}),(0,e.jsx)("div",{className:"col-span-2",children:m?(0,e.jsxs)(e.Fragment,{children:[i&&i.intent==="updateDetails"&&(0,e.jsx)(N,{heading:t("account.errorMessage"),message:i.message}),(0,e.jsxs)("div",{className:"flex gap-x-4",children:[(0,e.jsxs)(l,{type:"submit",isSubmitting:x==="submitting",children:[(0,e.jsx)(H,{className:"w-4 h-4"})," ",t("common.save")]}),(0,e.jsxs)(h,{type:"reset",onClick:()=>p(!1),children:[(0,e.jsx)(q,{className:"w-4 h-4"})," ",t("common.cancel")]})]})]}):(0,e.jsxs)(l,{type:"button",onClick:()=>p(!0),children:[(0,e.jsx)(f,{className:"w-4 h-4"})," ",t("common.edit")]})})]})]})})]})]})}export{V as default};
