import{a as ue,b as me,c as de,d as pe}from"/build/_shared/chunk-O7IFGE4T.js";import{a as fe,b as he}from"/build/_shared/chunk-JZSMHSRS.js";import{a as ie}from"/build/_shared/chunk-EXUR7XYC.js";import{a as R,b as oe,c as le,d as q,e as M}from"/build/_shared/chunk-TEQ7JZCS.js";import{D as ne,E as w,b as Q,d as D,i as H,j as E,k as re,s as se,t as L,v as K,x as B,y as U,z as O}from"/build/_shared/chunk-ZVWHBDYW.js";import{g as ce,n as z,o as _}from"/build/_shared/chunk-BPJTJPQP.js";import{l as ae}from"/build/_shared/chunk-NATW5ST3.js";import{C as P,E as x,a as C,l as Z,n as ee,p as te}from"/build/_shared/chunk-MTQ3NDKQ.js";import{d as p}from"/build/_shared/chunk-2QEWK57A.js";var W=class{_facetsWithValues=[];get facetsWithValues(){return this._facetsWithValues}update(a,r,n){this._facetsWithValues=this.groupFacetValues(r,a.facetValues,n)}groupFacetValues(a,r,n){if(!r)return[];let c=new Map;for(let{facetValue:{id:o,name:s,facet:d},count:i}of a.facetValues){if(i===a.totalItems)continue;let u=c.get(d.id),m=n.includes(o);u?u.values.push({id:o,name:s,selected:m}):c.set(d.id,{id:d.id,name:d.name,values:[{id:o,name:s,selected:m}]})}return Array.from(c.values())}};var S=p(x(),1);function Ue({filterCount:e,onClick:a}){let{t:r}=P();return(0,S.jsxs)("button",{type:"button",className:"flex space-x-2 items-center border rounded p-2 ml-4 sm:ml-6 text-gray-400 hover:text-gray-500 lg:hidden",onClick:a,children:[e?(0,S.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-primary-200 text-primary-800",children:e}):"",(0,S.jsx)("span",{children:r("common.filters")}),(0,S.jsx)(ce,{className:"w-5 h-5","aria-hidden":"true"})]})}var $=p(C(),1);var ye=p(C(),1);function ge(e){var a;if(e.type)return e.type;let r=(a=e.as)!=null?a:"button";if(typeof r=="string"&&r.toLowerCase()==="button")return"button"}function xe(e,a){let[r,n]=(0,ye.useState)(()=>ge(e));return Q(()=>{n(ge(e))},[e.type,e.as]),Q(()=>{r||a.current&&a.current instanceof HTMLButtonElement&&!a.current.hasAttribute("type")&&n("button")},[r,a]),r}var l=p(C(),1);var be=p(C(),1),ve,Pe=(ve=be.default.startTransition)!=null?ve:function(e){e()};var Se=(e=>(e[e.Open=0]="Open",e[e.Closed=1]="Closed",e))(Se||{}),Te=(e=>(e[e.ToggleDisclosure=0]="ToggleDisclosure",e[e.CloseDisclosure=1]="CloseDisclosure",e[e.SetButtonId=2]="SetButtonId",e[e.SetPanelId=3]="SetPanelId",e[e.LinkPanel=4]="LinkPanel",e[e.UnlinkPanel=5]="UnlinkPanel",e))(Te||{}),Ie={[0]:e=>({...e,disclosureState:E(e.disclosureState,{[0]:1,[1]:0})}),[1]:e=>e.disclosureState===1?e:{...e,disclosureState:1},[4](e){return e.linkedPanel===!0?e:{...e,linkedPanel:!0}},[5](e){return e.linkedPanel===!1?e:{...e,linkedPanel:!1}},[2](e,a){return e.buttonId===a.buttonId?e:{...e,buttonId:a.buttonId}},[3](e,a){return e.panelId===a.panelId?e:{...e,panelId:a.panelId}}},j=(0,l.createContext)(null);j.displayName="DisclosureContext";function G(e){let a=(0,l.useContext)(j);if(a===null){let r=new Error(`<${e} /> is missing a parent <Disclosure /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(r,G),r}return a}var X=(0,l.createContext)(null);X.displayName="DisclosureAPIContext";function Ne(e){let a=(0,l.useContext)(X);if(a===null){let r=new Error(`<${e} /> is missing a parent <Disclosure /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(r,Ne),r}return a}var J=(0,l.createContext)(null);J.displayName="DisclosurePanelContext";function Ce(){return(0,l.useContext)(J)}function De(e,a){return E(a.type,Ie,e,a)}var Re=l.Fragment;function Ve(e,a){let{defaultOpen:r=!1,...n}=e,c=(0,l.useRef)(null),o=L(a,se(y=>{c.current=y},e.as===void 0||e.as===l.Fragment)),s=(0,l.useRef)(null),d=(0,l.useRef)(null),i=(0,l.useReducer)(De,{disclosureState:r?0:1,linkedPanel:!1,buttonRef:d,panelRef:s,buttonId:null,panelId:null}),[{disclosureState:u,buttonId:m},v]=i,h=D(y=>{v({type:1});let T=re(c);if(!T||!m)return;let f=(()=>y?y instanceof HTMLElement?y:y.current instanceof HTMLElement?y.current:T.getElementById(m):T.getElementById(m))();f?.focus()}),F=(0,l.useMemo)(()=>({close:h}),[h]),b=(0,l.useMemo)(()=>({open:u===0,close:h}),[u,h]),A={ref:o};return l.default.createElement(j.Provider,{value:i},l.default.createElement(X.Provider,{value:F},l.default.createElement(le,{value:E(u,{[0]:R.Open,[1]:R.Closed})},B({ourProps:A,theirProps:n,slot:b,defaultTag:Re,name:"Disclosure"}))))}var Ee="button";function Le(e,a){let r=H(),{id:n=`headlessui-disclosure-button-${r}`,...c}=e,[o,s]=G("Disclosure.Button"),d=Ce(),i=d===null?!1:d===o.panelId,u=(0,l.useRef)(null),m=L(u,a,i?null:o.buttonRef),v=U();(0,l.useEffect)(()=>{if(!i)return s({type:2,buttonId:n}),()=>{s({type:2,buttonId:null})}},[n,s,i]);let h=D(f=>{var I;if(i){if(o.disclosureState===1)return;switch(f.key){case w.Space:case w.Enter:f.preventDefault(),f.stopPropagation(),s({type:0}),(I=o.buttonRef.current)==null||I.focus();break}}else switch(f.key){case w.Space:case w.Enter:f.preventDefault(),f.stopPropagation(),s({type:0});break}}),F=D(f=>{switch(f.key){case w.Space:f.preventDefault();break}}),b=D(f=>{var I;ne(f.currentTarget)||e.disabled||(i?(s({type:0}),(I=o.buttonRef.current)==null||I.focus()):s({type:0}))}),A=(0,l.useMemo)(()=>({open:o.disclosureState===0}),[o]),y=xe(e,u),T=i?{ref:m,type:y,onKeyDown:h,onClick:b}:{ref:m,id:n,type:y,"aria-expanded":o.disclosureState===0,"aria-controls":o.linkedPanel?o.panelId:void 0,onKeyDown:h,onKeyUp:F,onClick:b};return B({mergeRefs:v,ourProps:T,theirProps:c,slot:A,defaultTag:Ee,name:"Disclosure.Button"})}var Be="div",Oe=K.RenderStrategy|K.Static;function Me(e,a){let r=H(),{id:n=`headlessui-disclosure-panel-${r}`,...c}=e,[o,s]=G("Disclosure.Panel"),{close:d}=Ne("Disclosure.Panel"),i=U(),u=L(a,o.panelRef,b=>{Pe(()=>s({type:b?4:5}))});(0,l.useEffect)(()=>(s({type:3,panelId:n}),()=>{s({type:3,panelId:null})}),[n,s]);let m=oe(),v=(()=>m!==null?(m&R.Open)===R.Open:o.disclosureState===0)(),h=(0,l.useMemo)(()=>({open:o.disclosureState===0,close:d}),[o,d]),F={ref:u,id:n};return l.default.createElement(J.Provider,{value:o.panelId},B({mergeRefs:i,ourProps:F,theirProps:c,slot:h,defaultTag:Be,features:Oe,visible:v,name:"Disclosure.Panel"}))}var We=O(Ve),$e=O(Le),Ae=O(Me),k=Object.assign(We,{Button:$e,Panel:Ae});var t=p(x(),1);function Y({facetFilterTracker:e,mobileFiltersOpen:a,setMobileFiltersOpen:r}){let[n]=Z(),c=n.getAll("q"),{t:o}=P();return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(M.Root,{show:a,as:$.Fragment,children:(0,t.jsxs)(q,{as:"div",className:"relative z-40 lg:hidden",onClose:r,children:[(0,t.jsx)(M.Child,{as:$.Fragment,enter:"transition-opacity ease-linear duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"transition-opacity ease-linear duration-300",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:(0,t.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-25"})}),(0,t.jsx)("div",{className:"fixed inset-0 flex z-40",children:(0,t.jsx)(M.Child,{as:$.Fragment,enter:"transition ease-in-out duration-300 transform",enterFrom:"translate-x-full",enterTo:"translate-x-0",leave:"transition ease-in-out duration-300 transform",leaveFrom:"translate-x-0",leaveTo:"translate-x-full",children:(0,t.jsxs)(q.Panel,{className:"ml-auto relative max-w-xs w-full h-full bg-white shadow-xl py-4 pb-12 flex flex-col overflow-y-auto",children:[(0,t.jsxs)("div",{className:"px-4 flex items-center justify-between",children:[(0,t.jsx)("h2",{className:"text-lg font-medium text-gray-900",children:o("common.filters")}),(0,t.jsxs)("button",{type:"button",className:"-mr-2 w-10 h-10 bg-white p-2 rounded-md flex items-center justify-center text-gray-400",onClick:()=>r(!1),children:[(0,t.jsx)("span",{className:"sr-only",children:o("common.closeMenu")}),(0,t.jsx)(ae,{className:"h-6 w-6","aria-hidden":"true"})]})]}),(0,t.jsxs)("div",{className:"mt-4 border-t border-gray-200",children:[(0,t.jsx)("input",{type:"hidden",name:"q",value:c}),e.facetsWithValues.map(s=>(0,t.jsx)(k,{as:"div",defaultOpen:!0,className:"border-t border-gray-200 px-4 py-6",children:({open:d})=>(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("h3",{className:"-mx-2 -my-3 flow-root",children:(0,t.jsxs)(k.Button,{className:"px-2 py-3 bg-white w-full flex items-center justify-between text-gray-400 hover:text-gray-500",children:[(0,t.jsx)("span",{className:"font-medium text-gray-900 uppercase",children:s.name}),(0,t.jsx)("span",{className:"ml-6 flex items-center",children:d?(0,t.jsx)(z,{className:"h-5 w-5","aria-hidden":"true"}):(0,t.jsx)(_,{className:"h-5 w-5","aria-hidden":"true"})})]})}),(0,t.jsx)(k.Panel,{className:"pt-6",children:(0,t.jsx)("div",{className:"space-y-6",children:s.values.map((i,u)=>(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)("input",{id:`filter-mobile-${s.id}-${u}`,defaultValue:i.id,type:"checkbox",checked:i.selected,onChange:m=>{document.getElementById(`filter-${s.id}-${u}`).checked=m.target.checked},className:"h-4 w-4 border-gray-300 rounded text-primary-600 focus:ring-primary-500"}),(0,t.jsx)("label",{htmlFor:`filter-mobile-${s.id}-${u}`,className:"ml-3 min-w-0 flex-1 text-gray-500",children:i.name})]},i.id))})})]})},s.id))]})]})})})]})}),(0,t.jsxs)("div",{className:"hidden lg:block",children:[(0,t.jsx)("input",{type:"hidden",name:"q",value:c}),e.facetsWithValues.map(s=>(0,t.jsx)(k,{as:"div",defaultOpen:!0,className:"border-b border-gray-200 py-6",children:({open:d})=>(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("h3",{className:"-my-3 flow-root",children:(0,t.jsxs)(k.Button,{className:"py-3 bg-white w-full flex items-center justify-between text-sm text-gray-400 hover:text-gray-500",children:[(0,t.jsx)("span",{className:"font-medium text-gray-900 uppercase",children:s.name}),(0,t.jsx)("span",{className:"ml-6 flex items-center",children:d?(0,t.jsx)(z,{className:"h-5 w-5","aria-hidden":"true"}):(0,t.jsx)(_,{className:"h-5 w-5","aria-hidden":"true"})})]})}),(0,t.jsx)(k.Panel,{className:"pt-6",children:(0,t.jsx)("div",{className:"space-y-4",children:s.values.map((i,u)=>(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)("input",{id:`filter-${s.id}-${u}`,name:"fvid",defaultValue:i.id,type:"checkbox",checked:i.selected,onChange:()=>{},className:"h-4 w-4 border-gray-300 rounded text-primary-600 focus:ring-primary-500"}),(0,t.jsx)("label",{htmlFor:`filter-${s.id}-${u}`,className:"ml-3 text-sm text-gray-600",children:i.name})]},i.id))})})]})},s.id))]})]})}var N=p(x(),1);function Fe({productAsset:e,productName:a,slug:r,priceWithTax:n,currencyCode:c}){return(0,N.jsxs)(te,{className:"flex flex-col",prefetch:"intent",to:`/products/${r}`,children:[(0,N.jsx)("img",{className:"rounded-xl flex-grow object-cover aspect-[7/8]",alt:"",src:e?.preview+"?w=300&h=400"}),(0,N.jsx)("div",{className:"h-2"}),(0,N.jsx)("div",{className:"text-sm text-gray-700",children:a}),(0,N.jsx)("div",{className:"text-sm font-medium text-gray-900",children:(0,N.jsx)(ie,{priceWithTax:n,currencyCode:c})})]})}var V=p(x(),1);function ke({facetFilterTracker:e,...a}){let{t:r}=P();return(0,V.jsxs)("div",{...a,children:[(0,V.jsx)("h2",{className:"text-2xl sm:text-4xl font-light tracking-tight text-gray-900",children:r("product.noResults")}),e?.facetsWithValues.some(n=>n.values.some(c=>c.selected))&&(0,V.jsx)("h3",{className:"text-lg sm:text-2xl font-light tracking-tight text-gray-900",children:r("product.filterTip")})]})}var we=p(C(),1);var g=p(x(),1);function wt({result:e,resultWithoutFacetValueFilters:a,facetValueIds:r,appliedPaginationPage:n,appliedPaginationLimit:c,allowedPaginationLimits:o,mobileFiltersOpen:s,setMobileFiltersOpen:d}){let{t:i}=P(),u=(0,we.useRef)(new W);return u.current.update(e,a,r),(0,g.jsxs)("div",{className:"mt-6 grid sm:grid-cols-5 gap-x-4",children:[(0,g.jsx)(Y,{facetFilterTracker:u.current,mobileFiltersOpen:s,setMobileFiltersOpen:d}),e.items.length>0?(0,g.jsxs)("div",{className:"sm:col-span-5 lg:col-span-4 space-y-6",children:[(0,g.jsx)("div",{className:"grid grid-cols-1 gap-y-10 gap-x-6 sm:grid-cols-2 lg:grid-cols-4 xl:gap-x-8",children:e.items.map(m=>(0,g.jsx)(Fe,{...m},m.productId))}),(0,g.jsxs)("div",{className:"flex flex-row justify-between items-center gap-4",children:[(0,g.jsxs)("span",{className:"self-start text-gray-500 text-sm mt-2",children:[i("product.showing")," ",me(n,c)," ",i("product.to")," ",de(n,c,e.items.length)]}),(0,g.jsx)(pe,{appliedPaginationLimit:c,allowedPaginationLimits:o,totalItems:e.totalItems,appliedPaginationPage:n})]})]}):(0,g.jsx)(ke,{facetFilterTracker:u.current,className:"sm:col-span-4 sm:p-4"})]})}function Dt(e,a){let r=ue(e);return{validator:r,filteredSearchLoader:async({params:n,request:c})=>{let o=new URL(c.url),s=o.searchParams.get("q"),d=o.searchParams.getAll("fvid"),i=o.searchParams.get("limit")??a,u=o.searchParams.get("page")??1,m=r.safeParse({limit:i,page:u});if(!m.success)throw o.search="",ee(o.href);let v,h=fe({input:{groupByProduct:!0,term:s,facetValueFilters:[{or:d}],collectionSlug:n.slug,take:m.data.limit,skip:(m.data.page-1)*m.data.limit}},{request:c});d.length?v=[h,he({input:{groupByProduct:!0,term:s,collectionSlug:n.slug}},{request:c})]:v=[h,h];let[F,b]=await Promise.all(v);return{term:s,facetValueIds:d,result:F.search,resultWithoutFacetValueFilters:b.search,appliedPaginationLimit:m.data.limit,appliedPaginationPage:m.data.page}}}}export{W as a,Ue as b,wt as c,Dt as d};
